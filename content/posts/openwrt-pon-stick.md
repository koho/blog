---
title: "OpenWrt + Pon Stick 配置教程"
date: 2021-02-06T14:00:28+08:00
archives: 
    - 2021
draft: false
tags:
    - OpenWrt
    - 网络
image: /images/image-20210206141943.jpg
---

## 0x1 配置访问模块

首先确定模块插在哪个接口，本例中模块接在`eth1`上。确定模块IP，本例为192.168.1.1。下面配置一个接口，使内网的机器能直接访问模块。

1. 若OpenWrt的地址也是192.168.1.1，需要修改地址：

在网络->接口页面，编辑LAN接口，把IP地址改为172.20.0.1(其他网段亦可)。

![image-20210206140533987](/images/image-20210206140533987.png)

2.  新建一个接口，名字为PON，协议为静态IP，接口为eth1。

   ![image-20210206140607661](/images/image-20210206140607661.png)

配置IP地址为192.168.1.2，子网掩码为255.255.255.252.

![image-20210206140713965](/images/image-20210206140713965.png)

在防火墙设置选项卡里选择**分配给wan**，

![image-20210206140737761](/images/image-20210206140737761.png)

后续就可以访问模块地址进行配置，请参考模块配置教程。

## 0x2 拨号

这部分已经假定模块已经配置完成，并完成光路认证。还需要确定VLAN ID，一般在光猫的后台可以看到：

![image-20210206141209752](/images/image-20210206141209752.png)

在上网的连接名称可以看到后面的VID_41，41就是上网的VLAN ID。


回到OpenWrt页面，编辑WAN接口(没有的新建一个)，协议选择PPPoE，用户名密码照常输入，防火墙分配给wan. 要注意的是在**物理设置**选择**接口**那里，下拉到最后，在**自定义**输入框里输入**eth1.41, eth1是模块所在的接口，41是上面的上网VLAN ID。**

![image-20210206141245719](/images/image-20210206141245719.png)

后续应该就可以正常拨号上网了。